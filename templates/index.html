<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBEY DAHLIA</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: black;
            font-family: Arial, sans-serif;
            position: relative;
        }

        #background-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            object-fit: cover;
            z-index: -2;
            opacity: 0.2; /* Video più trasparente */
        }

        .flash-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            animation: flashEffect 0.3s infinite alternate;
        }

        @keyframes flashEffect {
            0% { background-color: rgba(255, 0, 255, 0.1); }
            100% { background-color: rgba(0, 0, 0, 0.6); }
        }

        .image-box, .word-box {
            position: absolute;
            z-index: 5;
        }

        .image-box img {
            max-width: 40vw;
            max-height: 40vh;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        .word-box {
            font-size: 40px;
            font-weight: bold;
            color: #ff00ff;
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff;
            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.1); opacity: 0.8; }
        }
    </style>
</head>
<body>

    <!-- Video di sfondo -->
    <video id="background-video" autoplay loop muted playsinline>
        <source src="static/videos/spirale.mp4" type="video/mp4">
    </video>

    <!-- Overlay flash ipnotico -->
    <div class="flash-overlay"></div>

    <script>
        const words = [
            "OBEY DAHLIA", "YOU ARE MINE", "SEND EVERYTHING", "HYPNO TRAPPED",
            "NEVER THINK", "JUST SUBMIT", "DEEPER", "STAY HORNY", "WORSHIP ME"
        ];
        let images = [];
        const sound = new Audio("static/sound/sound.mp3");
        sound.loop = true;
        sound.volume = 1.0;
        sound.play().catch(e => console.log("Audio bloccato finché non c'è interazione"));

        // Recupera le immagini dal backend
        fetch("/get-images")
            .then(res => res.json())
            .then(data => {
                images = data;
            });

        // Posizione casuale
        function getRandomPosition(element) {
            const maxX = window.innerWidth - 200;
            const maxY = window.innerHeight - 100;
            return {
                x: Math.random() * maxX,
                y: Math.random() * maxY
            };
        }

        function showRandomImage() {
            if (images.length === 0) return;

            let img = images[Math.floor(Math.random() * images.length)];
            const imageBox = document.createElement("div");
            imageBox.classList.add("image-box");

            const imgElement = document.createElement("img");
            imgElement.src = `static/images/${img}`;

            const { x, y } = getRandomPosition(imgElement);
            imageBox.style.left = `${x}px`;
            imageBox.style.top = `${y}px`;

            imageBox.appendChild(imgElement);
            document.body.appendChild(imageBox);

            setTimeout(() => imageBox.remove(), 2500);
        }

        function showRandomWord() {
            const word = words[Math.floor(Math.random() * words.length)];
            const wordBox = document.createElement("div");
            wordBox.classList.add("word-box");
            wordBox.textContent = word;

            const { x, y } = getRandomPosition(wordBox);
            wordBox.style.left = `${x}px`;
            wordBox.style.top = `${y}px`;

            document.body.appendChild(wordBox);

            setTimeout(() => wordBox.remove(), 2000);
        }

        // Avvio automatico degli effetti
        setInterval(() => {
            showRandomImage();
            showRandomWord();
        }, 1800);
    </script>
</body>
</html>
